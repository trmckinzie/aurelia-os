{% extends "base.html" %}

{% set active_page = "index" %}
{% block nav_title %}MAIN_HUB{% endblock %}

{% block head_extra %}
<style>
    /* === HOLO-CAROUSEL 3D ENGINE === */
    .carousel-scene {
        perspective: 1000px;
        overflow: hidden;
        height: 500px;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        margin-top: 4rem;
        /* FADE MASKS */
        mask-image: linear-gradient(to right, transparent, black 5%, black 95%, transparent);
        -webkit-mask-image: linear-gradient(to right, transparent, black 5%, black 95%, transparent);
    }
    .carousel {
        width: 300px;
        height: 400px;
        position: absolute;
        transform-style: preserve-3d;
        transition: transform 1s cubic-bezier(0.2, 0.8, 0.2, 1);
    }
    
    /* NOTE: We removed the .carousel-card CSS block here to allow 
       the JavaScript to control the styling dynamically. */

    .tech-readout {
        min-height: 100px;
        border-left: 2px solid {{ theme.colors.primary|replace("'", "") }};
        padding-left: 1.5rem;
        background: linear-gradient(90deg, {{ theme.colors.primary|replace("'", "") }}0D 0%, transparent 100%);
        margin-bottom: 4rem;
    }

    /* === GLITCH PROTOCOL === */
    .glitch-wrapper { position: relative; display: inline-block; }
    .glitch { position: relative; color: white; mix-blend-mode: lighten; }
    .glitch::before, .glitch::after {
        content: attr(data-text); position: absolute; top: 0; width: 100%; height: 100%; background: #0a0a0b; overflow: hidden; clip: rect(0, 0, 0, 0);
    }
    .glitch::before {
        left: -3px; text-shadow: 2px 0 {{ theme.colors.primary|replace("'", "") }};
        animation: glitch-anim-1 2.5s infinite linear alternate-reverse;
    }
    .glitch::after {
        left: 3px; text-shadow: -2px 0 {{ theme.colors.secondary|replace("'", "") }};
        animation: glitch-anim-2 3s infinite linear alternate-reverse;
    }
    @keyframes glitch-anim-1 {
        0% { clip: rect(20px, 9999px, 15px, 0); }
        20% { clip: rect(60px, 9999px, 80px, 0); }
        40% { clip: rect(10px, 9999px, 50px, 0); }
        60% { clip: rect(80px, 9999px, 10px, 0); }
        80% { clip: rect(30px, 9999px, 60px, 0); }
        100% { clip: rect(50px, 9999px, 30px, 0); }
    }
    @keyframes glitch-anim-2 {
        0% { clip: rect(10px, 9999px, 80px, 0); }
        20% { clip: rect(80px, 9999px, 10px, 0); }
        40% { clip: rect(30px, 9999px, 60px, 0); }
        60% { clip: rect(60px, 9999px, 20px, 0); }
        80% { clip: rect(10px, 9999px, 50px, 0); }
        100% { clip: rect(50px, 9999px, 30px, 0); }
    }

    /* === HYBRID PROTOCOL: DECRYPT + BIOLUMINESCENCE === */
    .decrypt-effect {
        font-family: 'JetBrains Mono', monospace;
        cursor: pointer;
        background: linear-gradient(to bottom, #ffffff 0%, {{ theme.colors.primary|replace("'", "") }} 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        color: transparent;
        filter: drop-shadow(0 0 15px {{ theme.colors.primary|replace("'", "") }}66);
        animation: bio-pulse 4s ease-in-out infinite alternate;
    }
    @keyframes bio-pulse {
        0% { filter: drop-shadow(0 0 10px {{ theme.colors.primary|replace("'", "") }}33); opacity: 0.8; }
        100% { filter: drop-shadow(0 0 25px {{ theme.colors.primary|replace("'", "") }}CC); opacity: 1; }
    }
</style>
{% endblock %}

{% block content %}
   <header class="mb-24 relative">
        <div class="font-mono text-[14px] text-aurelia-primary mb-4 flex items-center gap-2">
            <span class="opacity-100">[ STATUS: ]</span>
            <span class="text-aurelia-primary">{{ config.status_message }}</span>
        </div>

        <h1 class="text-6xl md:text-9xl font-bold text-aurelia-text tracking-tighter mb-8 uppercase leading-[0.8] glitch-wrapper">
            <span class="decrypt-effect" data-value="{{ config.system_name }}">{{ config.system_name }}</span>
        </h1>

        <p class="font-mono text-[26px] text-aurelia-text transition-colors mt-2">
            A Digital Architecture Experience by 
            <button onclick="openAbout()" class="text-aurelia-text hover:text-aurelia-accent hover:underline decoration-aurelia-accent underline-offset-8 transition-all duration-300 cursor-pointer font-bold animate-pulse hover:animate-none">
                {{ config.author.name }}
            </button>
        </p>

        <div class="border-l border-aurelia-dim pl-6 max-w-xl mt-6">
            <p class="font-mono text-md text-aurelia-accent leading-relaxed mb-6">
                > SYSTEM_READY<br>
                > {{ config.author.bio_short }}<br>
                > {{ config.author.role }}<br>
            </p>
            
            <button onclick="openManifesto()" class="mt-10 group flex items-center gap-3 text-md font-mono text-aurelia-primary border border-aurelia-primary/30 bg-aurelia-primary/5 px-8 py-4 hover:bg-aurelia-primary hover:text-black transition-all">
                <span> WHAT IS AURELIA OS? </span>
                <span class="group-hover:translate-x-1 transition-transform">-></span>
            </button>
        </div>    
    </header>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

        <a href="garden.html" class="group relative h-80 bg-[#050505] border border-gray-900 border-l-4 border-l-aurelia-primary p-8 overflow-hidden transition-all duration-300 hover:-translate-y-1 hover:shadow-[0_0_40px_rgba(0,242,255,0.15)] hover:border-aurelia-primary/50">
            <div class="absolute top-0 right-0 w-16 h-16 border-t-2 border-r-2 border-gray-800 group-hover:border-aurelia-primary transition-colors duration-300 rounded-tr-sm"></div>
            
            <div class="relative z-10 flex flex-col h-full justify-between">
                <div>
                    <div class="inline-block font-mono text-[10px] font-bold text-black bg-aurelia-primary px-2 py-1 mb-4 tracking-widest rounded-sm">
                        MOD_01 // INPUT
                    </div>
                    <h2 class="text-4xl font-bold text-white group-hover:text-aurelia-primary transition-colors tracking-tight">
                        The Garden
                    </h2>
                </div>
                
                <div class="font-mono text-xs text-gray-400 group-hover:text-white transition-colors border-l border-gray-800 pl-4 py-1">
                    <span class="text-aurelia-primary">></span> STATUS: VOLATILE<br>
                    <span class="text-aurelia-primary">></span> NOTES / SEEDS / RAW
                </div>
            </div>
            
            <div class="absolute -right-20 -bottom-20 w-80 h-80 bg-aurelia-primary/10 rounded-full blur-[100px] pointer-events-none group-hover:bg-aurelia-primary/20 transition-all"></div>
        </a>

        <a href="protocol.html" class="group relative h-80 bg-[#050505] border border-gray-900 border-l-4 border-l-aurelia-accent p-8 overflow-hidden transition-all duration-300 hover:-translate-y-1 hover:shadow-[0_0_40px_rgba(57,255,20,0.15)] hover:border-aurelia-accent/50">
            <div class="absolute top-0 right-0 w-16 h-16 border-t-2 border-r-2 border-gray-800 group-hover:border-aurelia-accent transition-colors duration-300 rounded-tr-sm"></div>
            
            <div class="relative z-10 flex flex-col h-full justify-between">
                <div>
                    <div class="inline-block font-mono text-[10px] font-bold text-black bg-aurelia-accent px-2 py-1 mb-4 tracking-widest rounded-sm">
                        MOD_02 // KERNEL
                    </div>
                    <h2 class="text-4xl font-bold text-white group-hover:text-aurelia-accent transition-colors tracking-tight">
                        System Protocols
                    </h2>
                </div>
                
                <div class="font-mono text-xs text-gray-400 group-hover:text-white transition-colors border-l border-gray-800 pl-4 py-1">
                    <span class="text-aurelia-accent">></span> STATUS: EXECUTING<br>
                    <span class="text-aurelia-accent">></span> ROUTINES / LOGIC
                </div>
            </div>
            
            <div class="absolute -right-20 -bottom-20 w-80 h-80 bg-aurelia-accent/10 rounded-full blur-[100px] pointer-events-none group-hover:bg-aurelia-accent/20 transition-all"></div>
        </a>

        <a href="portfolio.html" class="group relative h-80 bg-[#050505] border border-gray-900 border-l-4 border-l-aurelia-secondary p-8 overflow-hidden transition-all duration-300 hover:-translate-y-1 hover:shadow-[0_0_40px_rgba(138,43,226,0.15)] hover:border-aurelia-secondary/50">
            <div class="absolute top-0 right-0 w-16 h-16 border-t-2 border-r-2 border-gray-800 group-hover:border-aurelia-secondary transition-colors duration-300 rounded-tr-sm"></div>
            
            <div class="relative z-10 flex flex-col h-full justify-between">
                <div>
                    <div class="inline-block font-mono text-[10px] font-bold text-white bg-aurelia-secondary px-2 py-1 mb-4 tracking-widest rounded-sm">
                        MOD_03 // PROOF
                    </div>
                    <h2 class="text-4xl font-bold text-white group-hover:text-aurelia-secondary transition-colors tracking-tight">
                        Portfolio
                    </h2>
                </div>
                
                <div class="font-mono text-xs text-gray-400 group-hover:text-white transition-colors border-l border-gray-800 pl-4 py-1">
                    <span class="text-aurelia-secondary">></span> STATUS: PUBLISHED<br>
                    <span class="text-aurelia-secondary">></span> CASE STUDIES
                </div>
            </div>
            
            <div class="absolute -right-20 -bottom-20 w-80 h-80 bg-aurelia-secondary/10 rounded-full blur-[100px] pointer-events-none group-hover:bg-aurelia-secondary/20 transition-all"></div>
        </a>

        <a href="services.html" class="group relative h-80 bg-[#050505] border border-gray-900 border-l-4 border-l-aurelia-tertiary p-8 overflow-hidden transition-all duration-300 hover:-translate-y-1 hover:shadow-[0_0_40px_rgba(255,140,0,0.15)] hover:border-aurelia-tertiary/50">
            <div class="absolute top-0 right-0 w-16 h-16 border-t-2 border-r-2 border-gray-800 group-hover:border-aurelia-tertiary transition-colors duration-300 rounded-tr-sm"></div>
            
            <div class="relative z-10 flex flex-col h-full justify-between">
                <div>
                    <div class="inline-block font-mono text-[10px] font-bold text-black bg-aurelia-tertiary px-2 py-1 mb-4 tracking-widest rounded-sm">
                        MOD_04 // COMMERCE
                    </div>
                    <h2 class="text-4xl font-bold text-white group-hover:text-aurelia-tertiary transition-colors tracking-tight">
                        Services
                    </h2>
                </div>
                
                <div class="font-mono text-xs text-gray-400 group-hover:text-white transition-colors border-l border-gray-800 pl-4 py-1">
                    <span class="text-aurelia-tertiary">></span> STATUS: ACTIVE<br>
                    <span class="text-aurelia-tertiary">></span> ARCHITECTURE / BUILD
                </div>
            </div>
            
            <div class="absolute -right-20 -bottom-20 w-80 h-80 bg-aurelia-tertiary/10 rounded-full blur-[100px] pointer-events-none group-hover:bg-aurelia-tertiary/20 transition-all"></div>
        </a>

    </div>

    <section class="w-full max-w-[1400px] mx-auto mt-40 relative px-6">
        <div class="absolute inset-0 bg-[linear-gradient(rgba(0,242,255,0.03)_1px,transparent_1px),linear-gradient(90deg,rgba(0,242,255,0.03)_1px,transparent_1px)] bg-[size:40px_40px] [mask-image:radial-gradient(ellipse_60%_60%_at_50%_50%,#000_70%,transparent_100%)] pointer-events-none"></div>

        <div class="text-center mb-20 relative z-10">
            <div class="inline-flex items-center gap-4">
                <div class="h-px w-12 bg-gradient-to-r from-transparent to-aurelia-primary"></div>
                <h2 class="text-3xl md:text-5xl font-mono font-black text-white tracking-tighter uppercase drop-shadow-[0_0_10px_rgba(0,242,255,0.5)]">
                    NEURAL_LOADOUT
                </h2>
                <div class="h-px w-12 bg-gradient-to-l from-transparent to-aurelia-primary"></div>
            </div>
            <div class="mt-4 flex justify-center items-center gap-2 text-aurelia-primary font-mono text-xs tracking-[0.3em] opacity-80">
                <span>[ SYSTEM_ARCHITECTURE ]</span>
                <span class="animate-pulse">_</span>
            </div>
        </div>

        <div class="carousel-scene mb-16 h-[500px]">
            <div class="carousel" id="tech-carousel"></div>
        </div>

        <div class="max-w-4xl mx-auto relative z-20">
            
            <div class="flex items-center justify-between mb-8 px-4 md:px-12">
                 <button onclick="rotateCarousel(-1)" class="group flex items-center gap-3 text-gray-500 hover:text-aurelia-primary transition-colors">
                    <div class="w-12 h-12 border border-gray-800 group-hover:border-aurelia-primary group-hover:bg-aurelia-primary/10 flex items-center justify-center transition-all relative overflow-hidden backdrop-blur-sm">
                        <div class="absolute top-0 left-0 w-2 h-2 border-t border-l border-current"></div>
                        <div class="absolute bottom-0 right-0 w-2 h-2 border-b border-r border-current"></div>
                        <span class="font-mono text-2xl">&lt;</span>
                    </div>
                    <span class="hidden md:block font-mono text-[10px] tracking-widest opacity-0 group-hover:opacity-100 transition-opacity">PREV_MOD</span>
                </button>

                <div class="flex flex-col items-center gap-2">
                    <div class="w-24 h-px bg-gray-800 relative">
                        <div class="absolute inset-0 bg-aurelia-primary w-full animate-pulse shadow-[0_0_8px_#00f2ff]"></div>
                    </div>
                    <span class="text-[8px] font-mono text-aurelia-primary tracking-[0.2em] uppercase">System_Online</span>
                </div>

                <button onclick="rotateCarousel(1)" class="group flex items-center gap-3 text-gray-500 hover:text-aurelia-primary transition-colors flex-row-reverse">
                    <div class="w-12 h-12 border border-gray-800 group-hover:border-aurelia-primary group-hover:bg-aurelia-primary/10 flex items-center justify-center transition-all relative overflow-hidden backdrop-blur-sm">
                        <div class="absolute top-0 right-0 w-2 h-2 border-t border-r border-current"></div>
                        <div class="absolute bottom-0 left-0 w-2 h-2 border-b border-l border-current"></div>
                        <span class="font-mono text-2xl">&gt;</span>
                    </div>
                    <span class="hidden md:block font-mono text-[10px] tracking-widest opacity-0 group-hover:opacity-100 transition-opacity">NEXT_MOD</span>
                </button>
            </div>

            <div class="bg-[#050505] border border-gray-800 p-1 relative group">
                <div class="absolute inset-0 border border-aurelia-primary/30 opacity-50"></div>
                <div class="absolute top-0 left-0 w-full h-[1px] bg-gradient-to-r from-transparent via-aurelia-primary to-transparent opacity-20"></div>
                
                <div class="bg-[#0a0a0b] p-8 min-h-[160px] flex flex-col justify-center items-center text-center relative overflow-hidden">
                    <div class="absolute inset-0 bg-[linear-gradient(rgba(18,18,18,0.5)_50%,transparent_50%)] bg-[size:100%_4px] pointer-events-none opacity-20"></div>
                    
                    <h3 id="readout-title" class="text-2xl text-white font-mono font-bold mb-4 tracking-tight relative z-10 text-shadow-cyan">
                        SYSTEM_READY
                    </h3>
                    <p id="readout-desc" class="text-sm md:text-base text-gray-400 font-mono leading-relaxed max-w-2xl relative z-10">
                        Initiate rotation to inspect technical specifications.
                    </p>
                    
                    <div class="absolute bottom-2 right-2 text-[8px] font-mono text-gray-700">TERM_v3.0</div>
                </div>
            </div>
        </div>
    </section>

    <div id="manifesto-backdrop" class="fixed inset-0 bg-black/90 backdrop-blur-sm z-50 hidden flex items-center justify-center opacity-0 transition-opacity duration-300" onclick="closeManifesto()">
        <div id="manifesto-panel" class="bg-[#0a0a0b] border border-aurelia-primary/30 w-full max-w-4xl max-h-[85vh] rounded-lg shadow-[0_0_50px_rgba(0,242,255,0.1)] flex flex-col transform scale-95 transition-transform duration-300" onclick="event.stopPropagation()">
            <div class="flex justify-between items-center p-4 border-b border-gray-800 bg-black/50">
                <div class="flex items-center gap-2">
                    <div class="w-2 h-2 bg-aurelia-primary rounded-full animate-pulse"></div>
                    <span class="text-[10px] font-mono text-aurelia-primary uppercase tracking-widest">SYSTEM_MANIFESTO_V3.0</span>
                </div>
                <button onclick="closeManifesto()" class="text-gray-500 hover:text-aurelia-text transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <div class="p-8 overflow-y-auto font-sans leading-relaxed text-gray-300 space-y-6">
                <div class="border-l-2 border-aurelia-primary pl-4">
                    <h2 class="text-2xl font-bold text-aurelia-text mb-1">AURELIA OS</h2>
                    <p class="font-mono text-sm text-aurelia-primary tracking-wider">Augmented Understanding via Recursive Evolutionary Logic & Intelligent Analysis</p>
                </div>
                <div>
                    <h3 class="font-mono text-sm text-aurelia-text font-bold mb-2 uppercase border-b border-gray-800 pb-1 w-max">Mission Parameters</h3>
                    <p class="text-sm text-gray-200">
                        AURELIA is an <strong class="font-mono text-aurelia-primary">Externalized Cortex</strong>. It is a cybernetic extension of the biological mind designed to augment human cognition through the strategic integration of digital tools, AI agents, and evolutionary knowledge management principles. Its core mission is to enhance intellectual capacity by facilitating deeper understanding, fostering creativity, and enabling efficient knowledge synthesis. By leveraging recursive logic and intelligent analysis, AURELIA serves as a dynamic second brain that evolves alongside its user, adapting to their cognitive needs and promoting continuous intellectual growth.
                    </p>
                </div>
                <div>
                    <h3 class="font-mono text-sm text-aurelia-text font-bold mb-4 uppercase border-b border-gray-800 pb-1 w-max">System Definitions</h3>
                    <ul class="space-y-4 text-sm">
                        <li class="flex gap-3"><span class="font-mono text-aurelia-primary font-bold min-w-[20px]">[A]</span><div><strong class="text-aurelia-text">AUGMENTED:</strong><span class="text-gray-200 block mt-1">The use of digital prosthetics to extend biological cognitive limits.</span></div></li>
                        <li class="flex gap-3"><span class="font-mono text-aurelia-primary font-bold min-w-[20px]">[U]</span><div><strong class="text-aurelia-text">UNDERSTANDING:</strong><span class="text-gray-200 block mt-1">The shift from raw "Data" to synthesized "Wisdom".</span></div></li>
                        <li class="flex gap-3"><span class="font-mono text-aurelia-primary font-bold min-w-[20px]">[R]</span><div><strong class="text-aurelia-text">RECURSIVE:</strong><span class="text-gray-200 block mt-1">The logic of loops. Creating compound interest on knowledge.</span></div></li>
                        <li class="flex gap-3"><span class="font-mono text-aurelia-primary font-bold min-w-[20px]">[E]</span><div><strong class="text-aurelia-text">EVOLUTIONARY:</strong><span class="text-gray-200 block mt-1">Darwinian selection for ideas. Only "Cranes" survive.</span></div></li>
                        <li class="flex gap-3"><span class="font-mono text-aurelia-primary font-bold min-w-[20px]">[L]</span><div><strong class="text-aurelia-text">LOGIC:</strong><span class="text-gray-200 block mt-1">Validity is prioritized over intuition.</span></div></li>
                        <li class="flex gap-3"><span class="font-mono text-aurelia-primary font-bold min-w-[20px]">[I]</span><div><strong class="text-aurelia-text">INTELLIGENT:</strong><span class="text-gray-200 block mt-1">Integration of active agents (LLMs). Achieving goals under constraint.</span></div></li>
                        <li class="flex gap-3"><span class="font-mono text-aurelia-primary font-bold min-w-[20px]">[A]</span><div><strong class="text-aurelia-text">ANALYSIS:</strong><span class="text-gray-200 block mt-1">Atomic deconstruction of complex systems. Leveraging the Feynman Technique.</span></div></li>
                    </ul>
                </div>
            </div>
            <div class="p-2 border-t border-gray-800 bg-black/50 text-center">
                <span class="text-[9px] font-mono text-gray-600">PRESS ESC TO CLOSE // END_TRANSMISSION</span>
            </div>
        </div>
    </div>

    <div id="about-backdrop" class="fixed inset-0 bg-black/90 backdrop-blur-sm z-50 hidden flex items-center justify-center opacity-0 transition-opacity duration-300" onclick="closeAbout()">
        <div id="about-panel" class="bg-[#0a0a0b] border border-aurelia-accent/30 w-full max-w-4xl max-h-[85vh] rounded-lg shadow-[0_0_50px_rgba(57,255,20,0.1)] flex flex-col transform scale-95 transition-transform duration-300" onclick="event.stopPropagation()">
            
            <div class="flex justify-between items-center p-4 border-b border-gray-800 bg-black/50">
                <div class="flex items-center gap-2">
                    <div class="w-2 h-2 bg-aurelia-accent rounded-full animate-pulse"></div>
                    <span class="text-[10px] font-mono text-aurelia-accent uppercase tracking-widest">OPERATOR_PROFILE // {{ config.author.short_name }}</span>
                </div>
                <button onclick="closeAbout()" class="text-gray-500 hover:text-aurelia-texte transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                </button>
            </div>

            <div class="p-8 overflow-y-auto font-sans leading-relaxed text-gray-300 space-y-6">
                <div class="border-l-2 border-aurelia-accent pl-4">
                    <h2 class="text-2xl font-bold text-aurelia-text mb-1">{{ config.author.name | upper }}</h2>
                    <p class="font-mono text-sm text-aurelia-accent tracking-wider">{{ config.author.role }}</p>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 my-8">
                    <div class="bg-white/5 p-4 rounded border border-white/5">
                        <div class="text-aurelia-accent font-mono text-xs mb-2">LOCATION</div>
                        <div class="text-aurelia-text font-bold">{{ config.author.location }}</div>
                    </div>
                    <div class="bg-white/5 p-4 rounded border border-white/5">
                        <div class="text-aurelia-accent font-mono text-xs mb-2">SPECIALTY</div>
                        <div class="text-aurelia-text font-bold">{{ config.author.role }}</div>
                    </div>
                    <div class="bg-white/5 p-4 rounded border border-white/5">
                        <div class="text-aurelia-accent font-mono text-xs mb-2">STATUS</div>
                        <div class="text-aurelia-text font-bold flex items-center gap-2">
                            <span class="w-2 h-2 bg-aurelia-accent rounded-full animate-pulse"></span>
                            ONLINE
                        </div>
                    </div>
                </div>

                <div>
                    <h3 class="font-mono text-sm text-aurelia-text font-bold mb-2 uppercase border-b border-gray-800 pb-1 w-max">Mission Statement</h3>
                    <p class="text-sm text-gray-200">
                        {{ config.author.bio_long }}
                    </p>
                </div>
            </div>

            <div class="p-2 border-t border-gray-800 bg-black/50 text-center">
                <span class="text-[9px] font-mono text-gray-600">PRESS ESC TO CLOSE // END_PROFILE</span>
            </div>
        </div>
    </div>
{% endblock %}

{% block scripts %}
<script>
    /* --- DECRYPTION EFFECT ENGINE --- */
    const letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890!@#$%^&*()_+";
    document.querySelector(".decrypt-effect").onmouseover = event => {
        let iterations = 0;
        const interval = setInterval(() => {
            event.target.innerText = event.target.innerText.split("").map((letter, index) => {
                if(index < iterations) return event.target.dataset.value[index];
                return letters[Math.floor(Math.random() * 26)];
            }).join("");
            if(iterations >= event.target.dataset.value.length) clearInterval(interval);
            iterations += 1 / 8; 
        }, 30); 
    }
    window.onload = () => {
         const title = document.querySelector(".decrypt-effect");
         if(title) title.onmouseover({target: title});
    };

    /* --- MANIFESTO MODAL LOGIC --- */
    const mBackdrop = document.getElementById('manifesto-backdrop');
    const mPanel = document.getElementById('manifesto-panel');
    function openManifesto() {
        mBackdrop.classList.remove('hidden');
        setTimeout(() => {
            mBackdrop.classList.remove('opacity-0');
            mPanel.classList.remove('scale-95');
            mPanel.classList.add('scale-100');
        }, 10);
        document.body.style.overflow = 'hidden';
    }
    function closeManifesto() {
        mBackdrop.classList.add('opacity-0');
        mPanel.classList.remove('scale-100');
        mPanel.classList.add('scale-95');
        setTimeout(() => { mBackdrop.classList.add('hidden'); }, 300);
        document.body.style.overflow = 'auto';
    }

    /* --- OPERATOR BIO LOGIC (GREEN) --- */
    const aBackdrop = document.getElementById('about-backdrop');
    const aPanel = document.getElementById('about-panel');

    function openAbout() {
        aBackdrop.classList.remove('hidden');
        setTimeout(() => {
            aBackdrop.classList.remove('opacity-0');
            aPanel.classList.remove('scale-95');
            aPanel.classList.add('scale-100');
        }, 10);
        document.body.style.overflow = 'hidden';
    }

    function closeAbout() {
        aBackdrop.classList.add('opacity-0');
        aPanel.classList.remove('scale-100');
        aPanel.classList.add('scale-95');
        setTimeout(() => { aBackdrop.classList.add('hidden'); }, 300);
        document.body.style.overflow = 'auto';
    }

    // GLOBAL ESCAPE KEY HANDLER
    document.addEventListener('keydown', (e) => { 
        if (e.key === 'Escape') {
            closeManifesto();
            closeAbout();
        }
    });

    /* --- 3D CAROUSEL ENGINE (HIGH-CONTRAST EDITION) --- */
    document.addEventListener('DOMContentLoaded', () => {
        const carousel = document.getElementById('tech-carousel');
        const titleEl = document.getElementById('readout-title');
        const descEl = document.getElementById('readout-desc');

        // SAFETY CHECK: Abort if elements are missing
        if (!carousel || !titleEl || !descEl) {
            console.warn("System Alert: Carousel elements not detected. Skipping initialization.");
            return;
        }

        // DATA MATRIX (STANDARDIZED)

        // DATA MATRIX (DYNAMIC FROM CONFIG)
        const techStack = [
            {% for tech in config.tech_stack %}
            { 
                name: "{{ tech.name }}", 
                type: "{{ tech.type }}", 
                desc: "{{ tech.desc }}", 
                icon: "{{ tech.icon }}" 
            },
            {% endfor %}
        ];

        // PHYSICS CONFIG
        const cardCount = techStack.length;
        const radius = Math.round( (300 / 2) / Math.tan( Math.PI / cardCount ) ) + 50;
        const theta = 360 / cardCount;
        let currIndex = 0;

        // GLOBAL EXPOSURE (CRITICAL FIX)
        // We define this function here so it closes over variables, but assign it to window
        // so HTML buttons can access it.
        window.rotateCarousel = function(direction) {
            currIndex += direction;
            const angle = theta * currIndex * -1;
            carousel.style.transform = `translateZ(-${radius}px) rotateY(${angle}deg)`;
            updateReadout();
        };

        function updateReadout() {
            // Calculate valid index even with negative numbers
            let virtualIndex = currIndex % cardCount;
            if (virtualIndex < 0) virtualIndex += cardCount;
            
            const activeTech = techStack[virtualIndex];
            
            // TYPEWRITER EFFECT SIMULATION
            titleEl.style.opacity = '0.5';
            descEl.style.opacity = '0.5';
            
            setTimeout(() => {
                titleEl.innerText = activeTech.name + " //";
                descEl.innerText = activeTech.desc;
                
                titleEl.style.opacity = '1';
                descEl.style.opacity = '1';
            }, 150);
        }

        function initCarousel() {
            techStack.forEach((tech, i) => {
                const card = document.createElement('div');
                
                // FIX 1: Added 'absolute top-0 left-0' to force them into a stack (so they can rotate)
                // FIX 2: Added 'w-[300px] h-[400px]' to enforce size via Tailwind
                card.className = 'absolute top-0 left-0 w-[300px] h-[400px] group bg-[#0a0a0b] border border-gray-800 hover:border-aurelia-primary/50 transition-colors duration-500 cursor-pointer rounded-sm'; 
                
                // 3D POSITIONING
                const angle = theta * i;
                card.style.transform = `rotateY(${angle}deg) translateZ(${radius}px)`;
                
                // INNER HTML (Fixed Hover Logic)
                // We apply the scale to the INNER div so we don't break the outer 3D transform
                card.innerHTML = `
                    <div class="w-full h-full transform transition-transform duration-500 group-hover:scale-105 relative z-10 flex flex-col items-center justify-center p-6">
                        
                        <div class="absolute top-0 left-0 w-full h-0.5 bg-gradient-to-r from-transparent via-aurelia-primary to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>

                        <div class="text-7xl mb-6 opacity-80 filter drop-shadow-[0_0_15px_rgba(0,242,255,0.2)] transform group-hover:drop-shadow-[0_0_30px_rgba(0,242,255,0.6)] transition-all duration-500">
                            ${tech.icon}
                        </div>
                        
                        <h3 class="text-2xl font-bold text-white font-mono tracking-tighter mb-4 group-hover:text-aurelia-primary transition-colors">${tech.name}</h3>
                        
                        <span class="text-[9px] font-mono text-aurelia-primary tracking-[0.2em] uppercase border border-aurelia-primary/20 px-3 py-1 bg-aurelia-primary/5 rounded-sm">
                            ${tech.type}
                        </span>
                        
                        <div class="absolute bottom-0 right-0 w-3 h-3 border-b-2 border-r-2 border-gray-800 group-hover:border-aurelia-primary transition-colors"></div>
                        <div class="absolute top-0 left-0 w-3 h-3 border-t-2 border-l-2 border-gray-800 group-hover:border-aurelia-primary transition-colors"></div>
                    </div>
                `;
                
                // Interaction
                card.onclick = () => {
                    const diff = i - (currIndex % cardCount);
                    window.rotateCarousel(diff);
                };

                carousel.appendChild(card);
            });

            // --- NEW LINE: PUSH CAMERA BACK ON LOAD ---
        carousel.style.transform = `translateZ(-${radius}px) rotateY(0deg)`;
            
            updateReadout();
        }

        // LAUNCH
        initCarousel();
    });
</script>
{% endblock %}